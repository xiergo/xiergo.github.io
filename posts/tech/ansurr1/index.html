<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ANSURR:一种验证NMR蛋白结构准确性的方法 | Xiergo&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。 RCI: random coil index predicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free">
<meta name="author" content="
作者:&nbsp;Xiergo">
<link rel="canonical" href="https://xiergo.github.io/posts/tech/ansurr1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://xiergo.github.io/img/Q.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://xiergo.github.io/img/Q.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://xiergo.github.io/img/Q.jpg">
<link rel="apple-touch-icon" href="https://xiergo.github.io/img/Q.jpg">
<link rel="mask-icon" href="https://xiergo.github.io/img/Q.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
onload="renderMathInElement(document.body, 
    {
              delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '\\[', right: '\\]', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false}
              ]
          }
    );"></script>




<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="ANSURR:一种验证NMR蛋白结构准确性的方法" />
<meta property="og:description" content="开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。 RCI: random coil index predicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiergo.github.io/posts/tech/ansurr1/" />
<meta property="og:image" content="https://xiergo.github.io/posts/tech/ansurr1/0.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-07T13:33:44&#43;08:00" />
<meta property="article:modified_time" content="2023-01-07T13:33:44&#43;08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://xiergo.github.io/posts/tech/ansurr1/0.png" />
<meta name="twitter:title" content="ANSURR:一种验证NMR蛋白结构准确性的方法"/>
<meta name="twitter:description" content="开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。 RCI: random coil index predicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚文章",
      "item": "https://xiergo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "👨🏻‍💻 技术",
      "item": "https://xiergo.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "ANSURR:一种验证NMR蛋白结构准确性的方法",
      "item": "https://xiergo.github.io/posts/tech/ansurr1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ANSURR:一种验证NMR蛋白结构准确性的方法",
  "name": "ANSURR:一种验证NMR蛋白结构准确性的方法",
  "description": "开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。 RCI: random coil index predicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free",
  "keywords": [
    
  ],
  "articleBody": "\r开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。\nRCI: random coil index\npredicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free order parameters as well as per-residue RMSD of NMR and molecular dynamics ensembles from this parameter.\nchemical shift：\nIn nuclear magnetic resonance (NMR) spectroscopy, the chemical shift is the resonant frequency of an atomic nucleus relative to a standard in a magnetic field. Often the position and number of chemical shifts are diagnostic of the structure of a molecule. Chemical shifts are also used to describe signals in other forms of spectroscopy such as photoemission spectroscopy.\nSome atomic nuclei possess a magnetic moment (nuclear spin), which gives rise to different energy levels and resonance frequencies in a magnetic field. The total magnetic field experienced by a nucleus includes local magnetic fields induced by currents of electrons in the molecular orbitals (note that electrons have a magnetic moment themselves). The electron distribution of the same type of nucleus (e.g. 1H, 13C, 15N) usually varies according to the local geometry (binding partners, bond lengths, angles between bonds, and so on), and with it the local magnetic field at each nucleus. This is reflected in the spin energy levels (and resonance frequencies). The variations of nuclear magnetic resonance frequencies of the same kind of nucleus, due to variations in the electron distribution, is called the chemical shift. The size of the chemical shift is given with respect to a reference frequency or reference sample (see also chemical shift referencing), usually a molecule with a barely distorted electron distribution.\nMethods 计算RCI RCI， random coil index，对于每个残基可以计算一个局部蛋白灵活度（local protein flexibility），是主链二级化学位移（backbone secondary chemical shift）的加权平均的倒数。 $$ R_{RCI}=\\left ( \\frac{A|\\Delta\\delta_{C\\alpha}|+B|\\Delta\\delta_{CO}|+C|\\Delta\\delta_{C\\beta}|+D|\\Delta\\delta_{N}|+E|\\Delta\\delta_{NH}|+F|\\Delta\\delta_{H\\alpha}|}{A+B+C+D+E+F}\\right )^{-1} $$ $\\Delta\\delta_{I}$代表二级化学位移，A-F代表权重系数。不存在的原子或者没有化学位移数据的原子系数为0。没有氧原子？\n计算FIRST FIRST: Floppy inclusions and rigid substructure topography\n对于一个蛋白质结构，FIRST生成由节点组成的约束网络图。其中节点表示原子，边表示局部几何施加的约束。单共价键用原子之间的五个边表示，双键用六条边表示，疏水相互作用用两条边，氢键用1～5条边。\n原子可以看作刚体，每个原子有六个自由度（三个位置和三个方向）。当有约束存在时，自由度会减少。一条边会减少至多一个自由度。比如，单共价键可以消除两个键合原子之间至多五个自由度。然后，FIRST使用组合卵石博弈算法（combinatorial pebble game algrithom）将图快速分解为最大刚性簇(maximum rigid clusters)和柔性区域(flexible regions)，这一过程称为刚性簇分解(rigid cluster decomposition)。如果Cα原子属于包含至少15个原子的刚性簇，我们认为残基是刚性的，这样做可以防止脯氨酸和芳香族残基自动标记为刚性。\n相对灵活度（relative flexibility）使用氢键稀释（hydrogen bond dilution）的过程进行量化，该过程类似于蛋白质的热变性。逐步去除图中氢键的边，重复刚性簇分解并关注每个残基的Cα原子不再是刚性簇一部分（即变得灵活）时的氢键能量。稀释图的一个重要好处是每个氢键的绝对能量对分析并不重要。我们对此进行了轻微调整，将能量转换为298.15 K的玻尔兹曼种群比（Boltzmann population ratio），以表示残基是柔性（flexible）的概率。\n简单网络的最终鹅卵石覆盖物的示意图。自由鹅卵石直接放置在顶点上，表示自由度 。覆盖边的鹅卵石直接放置在图形的边上，表示距离约束。鹅卵石覆盖并不是唯一的，因为鹅卵石可以一些简单规则重新排列。图中展示了一个鹅卵石交换的示例（两个箭头）。\r对比RCI和FIRST RCI 和 FIRST 的直接比较并不理想，因为 RCI 和 FIRST 输出值的频率分布不同，于是我们对初始RCI值进行了调整，使得RCI和FIRST可比。调整前后的结果如下图所示：\n$$ R_{RCI}^{’}=\\min{\\left(\\frac{\\max ((R_{RCI}-0.024),0)}{0.2-0.024},1\\right)} $$\n初始RCI (a) 和 FIRST (b)的输出值的频率分布直方图；CNW数据集(c)和随机sample的PDB数据集(d)上调整后RCI值和FIRST值的分布图\r验证得分 使用Spearman相关系数和RMSD，RMSD计算如下： $$ \\text{RMSD}=\\sqrt{\\frac{\\sum(R_{RCI}^{’}-R_{FIRST})^2}{N}} $$ 其中，N是残基数目。相关性评分和RMSD评分的数值表示为相对于参考数据集的百分位数，该参考数据集由RECOORD重新计算的结构数据库中的CNS和CNW数据集构成，这些参考数据集涵盖了显式溶剂细化前后不同折叠类型的代表蛋白结构。\nCode availability 安装及使用 ANSURR: Github\nhttps://www.github.com/nickjf/ANSURR\n安装：\n1 pip install ansurr 使用文档：\n使用文档\rANSURR需要提供两个文件：\na NMR protein structure in PDB format a shifts file in NEF format (or NMR Star v3 format) 比如：\nBeR31_2k2e.nef\rTo re-reference chemical shifts using PANAV before running ANSURR (recommended):\n1 ansurr -p xxxx.pdb -s xxxx.nef -r To run without re-referencing chemical shifts:\n1 ansurr -p xxxx.pdb -s xxxx.nef 输出 一个总的打分文件：score.out score.out：总共有20个models\r所有模型的分数的散点图： 所有模型散点图\r每个模型有一个详细的打分文件： 第3列往后依次是：flexibility predicted by RCI, flexibility predicted by FIRST, secondary structure according to DSSP, well-defined regions of the ensemble according to CYRANGE, backbone chemcial shift completeness and which atom types have chemical shift data\nModel 1 的详细打分文件\r每个模型有一个图： Model 1 的RCI（蓝色）和FIRST（橙色）预测的蛋白质灵活性图。α螺旋和β片二级结构分别用红点和蓝点表示。\r除此之外还有一些分析的中间过程文件\nPANAV/ - re-referenced chemical shifts RCI/ - flexibility predicted from chemical shifts using RCI extracted_pdbs/ - PDB files for each model extracted from the NMR structure DSSP/ - secondary structure for each model according to the program DSSP FIRST/ - flexibility predicted for each model using FIRST 参考文献 A method for validating the accuracy of NMR protein structures Protein flexibility predictions using graph theory ",
  "wordCount" : "1953",
  "inLanguage": "en",
  "image":"https://xiergo.github.io/posts/tech/ansurr1/0.png","datePublished": "2023-01-07T13:33:44+08:00",
  "dateModified": "2023-01-07T13:33:44+08:00",
  "author":[{
    "@type": "Person",
    "name": "Xiergo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://xiergo.github.io/posts/tech/ansurr1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xiergo's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://xiergo.github.io/img/Q.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>



<script async src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>


<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://xiergo.github.io/" accesskey="h" title="Xiergo&#39;s Blog (Alt + H)">
            <img src="https://xiergo.github.io/img/Q.jpg" alt="logo" aria-label="logo"
                 height="35">Xiergo&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://xiergo.github.io/search" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                <span>🔍 搜索</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/" title="🏠 主页">
                <span>🏠 主页</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/posts" title="📚 文章">
                <span>📚 文章</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/tags" title="🧩 标签">
                <span>🧩 标签</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/archives/" title="⏱️ 时间轴">
                <span>⏱️ 时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/about" title="🙋🏻‍♂️ 关于">
                <span>🙋🏻‍♂️ 关于</span>
                </a>
            </li>
            <li>
                <a href="https://xiergo.github.io/links" title="🤝 友链">
                <span>🤝 友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://xiergo.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://xiergo.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://xiergo.github.io/posts/tech/">👨🏻‍💻 技术</a></div>
            <h1 class="post-title">
                ANSURR:一种验证NMR蛋白结构准确性的方法
            </h1>
            <div class="post-meta">创建:&nbsp;<span title='2023-01-07 13:33:44 +0800 CST'>2023-01-07</span>&nbsp;|&nbsp;更新:&nbsp;2023-01-07&nbsp;|&nbsp;字数:&nbsp;1953字&nbsp;|&nbsp;时长:&nbsp;4分钟&nbsp;|&nbsp;
作者:&nbsp;Xiergo



                &nbsp;|&nbsp;标签: &nbsp;

                
                <span id="busuanzi_container_page_pv">
                &nbsp;| 访问: <span id="busuanzi_value_page_pv"></span>
            </span>

</div>
        </header> 
<figure class="entry-cover1"><img loading="lazy" src="https://xiergo.github.io/posts/tech/ansurr1/0.png" alt="">
        
</figure>
        <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">文章目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#methods" aria-label="Methods">Methods</a><ul>
                        
                <li>
                    <a href="#%e8%ae%a1%e7%ae%97rci" aria-label="计算RCI">计算RCI</a></li>
                <li>
                    <a href="#%e8%ae%a1%e7%ae%97first" aria-label="计算FIRST">计算FIRST</a></li>
                <li>
                    <a href="#%e5%af%b9%e6%af%94rci%e5%92%8cfirst" aria-label="对比RCI和FIRST">对比RCI和FIRST</a></li>
                <li>
                    <a href="#%e9%aa%8c%e8%af%81%e5%be%97%e5%88%86" aria-label="验证得分">验证得分</a></li></ul>
                </li>
                <li>
                    <a href="#code-availability" aria-label="Code availability">Code availability</a><ul>
                        
                <li>
                    <a href="#%e5%ae%89%e8%a3%85%e5%8f%8a%e4%bd%bf%e7%94%a8" aria-label="安装及使用">安装及使用</a></li>
                <li>
                    <a href="#%e8%be%93%e5%87%ba" aria-label="输出">输出</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" aria-label="参考文献">参考文献</a>
                </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        
        <div class="post-content"><!--
添加图片方法

<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/yeast_display/1.jpg">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">图注写这里</div>
</center>

-->
<p>开发了一种测量NMR蛋白结构准确性的方法。该方法比较RCI和通过数学刚性理论从NMR结构中计算得到的局部刚性（local rigidity）的相关性（二级结构）和RMSD（全局刚性，overall rigidity），并且进行后续的评估。</p>
<blockquote>
<p><strong>RCI: random coil index</strong></p>
<p>predicts protein flexibility by calculating an inverse weighted average of backbone secondary chemical shifts and predicting values of model-free order parameters as well as per-residue RMSD of NMR and molecular dynamics ensembles from this parameter.</p>
<p><strong>chemical shift：</strong></p>
<p>In nuclear magnetic resonance (NMR) spectroscopy, the chemical shift is the resonant frequency of an atomic nucleus relative to a standard in a magnetic field. Often the position and number of chemical shifts are diagnostic of the structure of a molecule. Chemical shifts are also used to describe signals in other forms of spectroscopy such as photoemission spectroscopy.</p>
<p>Some atomic nuclei possess a magnetic moment (nuclear spin), which gives rise to different energy levels and resonance frequencies in a magnetic field. The total magnetic field experienced by a nucleus includes local magnetic fields induced by currents of electrons in the molecular orbitals (note that electrons have a magnetic moment themselves). The electron distribution of the same type of nucleus (e.g. 1H, 13C, 15N) usually varies according to the local geometry (binding partners, bond lengths, angles between bonds, and so on), and with it the local magnetic field at each nucleus. This is reflected in the spin energy levels (and resonance frequencies). The variations of nuclear magnetic resonance frequencies of the same kind of nucleus, due to variations in the electron distribution, is called the chemical shift. The size of the chemical shift is given with respect to a reference frequency or reference sample (see also chemical shift referencing), usually a molecule with a barely distorted electron distribution.</p>
</blockquote>
<h1 id="methods">Methods<a hidden class="anchor" aria-hidden="true" href="#methods">#</a></h1>
<h2 id="计算rci">计算RCI<a hidden class="anchor" aria-hidden="true" href="#计算rci">#</a></h2>
<p>RCI， random coil index，对于每个残基可以计算一个局部蛋白灵活度（local protein flexibility），是主链二级化学位移（backbone secondary chemical shift）的加权平均的倒数。
$$
R_{RCI}=\left ( \frac{A|\Delta\delta_{C\alpha}|+B|\Delta\delta_{CO}|+C|\Delta\delta_{C\beta}|+D|\Delta\delta_{N}|+E|\Delta\delta_{NH}|+F|\Delta\delta_{H\alpha}|}{A+B+C+D+E+F}\right )^{-1}
$$
$\Delta\delta_{I}$代表二级化学位移，A-F代表权重系数。不存在的原子或者没有化学位移数据的原子系数为0。没有氧原子？</p>
<h2 id="计算first">计算FIRST<a hidden class="anchor" aria-hidden="true" href="#计算first">#</a></h2>
<p>FIRST: Floppy inclusions and rigid substructure topography</p>
<p>对于一个蛋白质结构，FIRST生成由节点组成的约束网络图。其中节点表示原子，边表示局部几何施加的约束。单共价键用原子之间的五个边表示，双键用六条边表示，疏水相互作用用两条边，氢键用1～5条边。</p>
<p>原子可以看作刚体，每个原子有六个自由度（三个位置和三个方向）。当有约束存在时，自由度会减少。一条边会减少至多一个自由度。比如，单共价键可以消除两个键合原子之间至多五个自由度。然后，FIRST使用组合卵石博弈算法（combinatorial pebble game algrithom）将图快速分解为最大刚性簇(maximum rigid clusters)和柔性区域(flexible regions)，这一过程称为刚性簇分解(rigid cluster decomposition)。如果Cα原子属于包含至少15个原子的刚性簇，我们认为残基是刚性的，这样做可以防止脯氨酸和芳香族残基自动标记为刚性。</p>
<p>相对灵活度（relative flexibility）使用氢键稀释（hydrogen bond dilution）的过程进行量化，该过程类似于蛋白质的热变性。逐步去除图中氢键的边，重复刚性簇分解并关注每个残基的Cα原子不再是刚性簇一部分（即变得灵活）时的氢键能量。稀释图的一个重要好处是每个氢键的绝对能量对分析并不重要。我们对此进行了轻微调整，将能量转换为298.15 K的玻尔兹曼种群比（Boltzmann population ratio），以表示残基是柔性（flexible）的概率。</p>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/7.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">简单网络的最终鹅卵石覆盖物的示意图。自由鹅卵石直接放置在顶点上，表示自由度 。覆盖边的鹅卵石直接放置在图形的边上，表示距离约束。鹅卵石覆盖并不是唯一的，因为鹅卵石可以一些简单规则重新排列。图中展示了一个鹅卵石交换的示例（两个箭头）。</div>
</center>
<h2 id="对比rci和first">对比RCI和FIRST<a hidden class="anchor" aria-hidden="true" href="#对比rci和first">#</a></h2>
<p>RCI 和 FIRST 的直接比较并不理想，因为 RCI 和 FIRST 输出值的频率分布不同，于是我们对初始RCI值进行了调整，使得RCI和FIRST可比。调整前后的结果如下图所示：</p>
<p>$$
R_{RCI}^{&rsquo;}=\min{\left(\frac{\max ((R_{RCI}-0.024),0)}{0.2-0.024},1\right)}
$$</p>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/8.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">初始RCI (a) 和 FIRST (b)的输出值的频率分布直方图；CNW数据集(c)和随机sample的PDB数据集(d)上调整后RCI值和FIRST值的分布图</div>
</center>
<h2 id="验证得分">验证得分<a hidden class="anchor" aria-hidden="true" href="#验证得分">#</a></h2>
<p>使用Spearman相关系数和RMSD，RMSD计算如下：
$$
\text{RMSD}=\sqrt{\frac{\sum(R_{RCI}^{&rsquo;}-R_{FIRST})^2}{N}}
$$
其中，N是残基数目。相关性评分和RMSD评分的数值表示为相对于参考数据集的百分位数，该参考数据集由RECOORD重新计算的结构数据库中的CNS和CNW数据集构成，这些参考数据集涵盖了显式溶剂细化前后不同折叠类型的代表蛋白结构。</p>
<h1 id="code-availability">Code availability<a hidden class="anchor" aria-hidden="true" href="#code-availability">#</a></h1>
<h2 id="安装及使用">安装及使用<a hidden class="anchor" aria-hidden="true" href="#安装及使用">#</a></h2>
<p>ANSURR: Github</p>
<p><a href="https://www.github.com/nickjf/ANSURR">https://www.github.com/nickjf/ANSURR</a></p>
<p>安装：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install ansurr
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用文档：</p>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/1.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">使用文档</div>
</center>
<p>ANSURR需要提供两个文件：</p>
<ol>
<li>a NMR protein structure in PDB format</li>
<li>a shifts file in NEF format (or NMR Star v3 format)</li>
</ol>
<p>比如：</p>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/2.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">BeR31_2k2e.nef</div>
</center>
<p>To re-reference chemical shifts using PANAV before running ANSURR (recommended):</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ansurr -p xxxx.pdb -s xxxx.nef -r
</span></span></code></pre></td></tr></table>
</div>
</div><p>To run without re-referencing chemical shifts:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ansurr -p xxxx.pdb -s xxxx.nef
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="输出">输出<a hidden class="anchor" aria-hidden="true" href="#输出">#</a></h2>
<ol>
<li>一个总的打分文件：score.out</li>
</ol>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/3.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">score.out：总共有20个models</div>
</center>
<ol start="2">
<li>所有模型的分数的散点图：</li>
</ol>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/6.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">所有模型散点图</div>
</center>
<ol start="3">
<li>每个模型有一个详细的打分文件：</li>
</ol>
<p>第3列往后依次是：flexibility predicted by RCI, flexibility predicted by FIRST, secondary structure according to DSSP, well-defined regions of the ensemble according to CYRANGE, backbone chemcial shift completeness and which atom types have chemical shift data</p>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/4.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">Model 1 的详细打分文件</div>
</center>
<ol start="4">
<li>每个模型有一个图：</li>
</ol>
<center>
    <img  style="border-radius:0.3125em;
    box-shadow: 0 4px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/tech/ansurr1/5.png">
    <div style="color:gray; border-bottom: 1px solid gray;
    display: inline-block;">Model 1 的RCI（蓝色）和FIRST（橙色）预测的蛋白质灵活性图。α螺旋和β片二级结构分别用红点和蓝点表示。
</div>
</center>
<p>除此之外还有一些分析的中间过程文件</p>
<ul>
<li><code>PANAV/</code> - re-referenced chemical shifts</li>
<li><code>RCI/</code> - flexibility predicted from chemical shifts using RCI</li>
<li><code>extracted_pdbs/</code> - PDB files for each model extracted from the NMR structure</li>
<li><code>DSSP/</code> - secondary structure for each model according to the program DSSP</li>
<li><code>FIRST/</code> - flexibility predicted for each model using FIRST</li>
</ul>
<h1 id="参考文献">参考文献<a hidden class="anchor" aria-hidden="true" href="#参考文献">#</a></h1>
<ol>
<li><a href="https://www.nature.com/articles/s41467-020-20177-1#Sec17">A method for validating the accuracy of NMR protein structures</a></li>
<li><a href="https://onlinelibrary.wiley.com/doi/10.1002/prot.1081">Protein flexibility predictions using graph theory</a></li>
</ol>


        </div>
        <div class="post-reward">
            <div style="padding: 0 0 0 0; margin: 0 0 0 0; width: 100%; font-size:16px; text-align: center;">
                <div id="QR" style="opacity: 0;">
                    <div id="wechat" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="wechat_qr" src="https://xiergo.github.io/img/wechat_pay.png" alt="wechat_pay"></a>
                        <p>微信</p>
                    </div>
                    <div id="alipay" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="alipay_qr" src="https://xiergo.github.io/img/alipay.png" alt="alipay"></a>
                        <p>支付宝</p>
                    </div>
                </div>
                <button id="rewardButton"
                        onclick="
                    var qr = document.getElementById('QR');
                    if (qr.style.opacity === '0') {
                        qr.style.opacity='1';
                    } else {
                        qr.style.opacity='0'
                    }"
                >
                    <span>🧧 鼓励</span>
                </button>
            </div>
        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="next" href="https://xiergo.github.io/posts/tech/ansurr/">
    <span class="title">下一页 »</span>
    <br>
    <span>使用AF2和NMR确定的溶液中蛋白结构的准确性</span>
  </a>
</nav>

        </footer>
    </div>



<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">💬评论</span>
        <hr />
    </div>

    <div id="tcomment"></div>

    <script src="https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js">
    </script>
    

    

    <script>
        twikoo.init({
            envId: "https://twikooapi.vercel.app", 
            el: "#tcomment",
            lang: 'zh-CN',
            region: "ap-beijing",
            path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
            
            
            
            
            
            
            
        });
    </script>

</div>
</article>
</main>


<script async src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<footer class="footer">
    <span>
        Copyright
        &copy;
        -2023
        <a href="https://xiergo.github.io/" style="color:#939393;">Xiergo&#39;s Blog</a>
        All Rights Reserved
    </span>

    <a href="https://beian.miit.gov.cn/" target="_blank" style="color:#939393;"></a>&nbsp;

    <span>
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null"
           style="display:inline-block;text-decoration:none;height:20px;color:#939393;">
            <img src="" style="float:left;margin: 0px 5px 0px 0px;"/>
            
        </a>
    </span>

    <span id="busuanzi_container">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        总访客数: <span id="busuanzi_value_site_uv"></span>
        总访问量: <span id="busuanzi_value_site_pv"></span>
    </span>

</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 400 || document.documentElement.scrollTop > 400) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「' + {
                { .
                    Site.Title
                }
            }
                +'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「' + {
                { .
                    Site.Title
                }
            }
                +'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = '📄复制';

        function copyingDone() {
            copybutton.innerText = '👌🏻已复制!';
            setTimeout(() => {
                copybutton.innerText = '📄复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\n————————————————\r\n' +
                    '版权声明：本文为「' + "Xiergo's Blog"
                +'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {
            }
            ;
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild === container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName === "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
    })
</script>
</body>

</html>
